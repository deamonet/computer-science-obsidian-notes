互联网交换点 (IXP) 是互联网基础设施公司（如互联网服务提供商 (ISP) 和 CDN）相互连接的物理位置。

## 什么是互联网交换点？

互联网交换点 (IXP) 是一个物理位置，互联网服务提供商 (ISP) 和 [CDN](https://www.cloudflare.com/learning/cdn/what-is-a-cdn/) 之类的互联网基础设施公司通过它相互连接。这些地点存在于[不同网络的“边缘”](https://www.cloudflare.com/learning/cdn/glossary/edge-server/)，并允许网络提供商在他们自己的网络之外共享传输。通过在 IXP 位置内有一个存在点，公司能够缩短与其他参与网络的传输路径，从而减少[延迟](https://www.cloudflare.com/learning/performance/glossary/what-is-latency/)，改善[往返时间](https://www.cloudflare.com/learning/cdn/glossary/round-trip-time-rtt/)，并有可能降低成本。

## 互联网交换点如何运作？

究其核心，IXP 本质上是一个或多个物理位置，其中包含在不同成员网络之间路由流量的网络交换机。通过各种方法，这些网络分担维护物理基础设施和相关服务的成本。类似于通过第三方地点（例如通过巴拿马运河）运输货物时产生的成本，当流量通过不同的网络传输时，有时这些网络会收取运费。为了避免这些成本和与通过第三方网络发送流量相关的其他缺点，成员公司通过 IXP 相互连接以降低成本并减少延迟。

IXP 是（[OSI 网络模型](https://www.cloudflare.com/learning/ddos/glossary/open-systems-interconnection-model-osi/)的）大型第 2 层 LAN，由一个或多个以太网交换机构建而成，这些交换机跨一个或多个物理建筑物互连在一起。IXP 在基本概念上与家庭网络没有什么不同，唯一真正的区别是规模。IXP 的范围可以从 100s MB/S 到每秒许多 TB 的交换流量。无论大小，他们的主要目标都是确保许多网络的路由器干净有效地连接在一起。相比之下，在家中通常只有一个路由器和许多计算机或移动设备。

在过去的二十年中，网络互连出现了重大扩展，与全球互联网的巨大扩展并行。这种扩展包括正在开发的用于容纳网络设备的新数据中心设施。其中一些数据中心已经吸引了大量的网络，这在很大程度上要归功于在其中运行的蓬勃发展的互联网交换点。

## 为什么互联网交换点很重要？

如果没有 IXP，从一个网络到另一个网络的流量可能会依赖中间网络将流量从源传送到目的地。这些被称为传输提供商。在某些情况下，这样做没有问题：大部分国际互联网流量都是这样流动的，因为与世界上的每一个 ISP 都维持直接连接成本高昂。但是，依靠骨干 ISP 传送本地流量可能会对性能产生不利影响，有时是因为骨干运营商将数据发送到完全不同城市的另一个网络。这种情况可能导致所谓的长号，在最坏的情况下，从一个城市到相同城市另一个 ISP 的流量可能要传播很远的距离进行交换，然后再次返回。具有 IXP 存在的 CDN 具有优化数据在其网络中流动的路径、减少低效路径的优势。

![长号效应](https://www.cloudflare.com/img/learning/cdn/glossary/IxP/trombone-effect.png "长号效应")

## BGP，互联网的骨干协议

网络之间使用 [BGP（边界网关协议）](https://www.cloudflare.com/learning/security/glossary/what-is-bgp/)互相沟通。该协议允许网络在其内部要求和网络边缘配置之间进行明确的划分。IXP 的所有对等都使用 BGP。

## 提供商如何在跨不同提供商共享流量？

#### 传输

客户与其上游提供商之间的协议。传输提供商为其客户提供与互联网其余部分的完全连接。传输是一项有偿服务。BGP 协议用于允许向传输提供商公告客户的 [IP 地址](https://www.cloudflare.com/learning/dns/glossary/what-is-my-ip-address/)，然后再向全球互联网的其他部分公告。

#### 对等互连

网络之间不需要中间人就可以共享 IP 地址的安排。在互联网交换点，在成员网络之间传输数据基本上没有成本。当流量从一个网络免费传输到下一个网络时，这种关系称为免费对等互连。

#### 对等互连与付费传输

遗憾的是，对于一些网络来说，传输数据并非总是没有成本。例如，市场份额相对相等的大型网络更有可能与其他大型网络对等，但可能会向较小的网络收取对等服务的费用。在一个 IXP 中，一个成员公司可能与几个不同的成员有不同的安排。在这种情况下，公司可以配置他们的路由协议，以确保他们使用 BGP 协议优化以降低成本或减少延迟。

#### Depeering

随着时间的推移，关系可能会发生变化，有时网络不再希望共享免费互连。当一个网络决定结束他们的对等互连安排时，他们会经历一个称为 depeering 的过程。Depeering 可能由于多种原因而发生，例如由于糟糕的流量比率而导致一方比另一方受益更多时，或者当一个网络简单决定开始向另一方收费时。这个过程可能是高度情绪化的，一旦对等互连关系终止，被拒绝的网络可能会故意扰乱对方的流量。

#### IXP 如何使用 BGP？

在 IXP 的本地网络中，不同的提供商能够使用 BGP 协议创建一对一的连接。创建此协议是为了允许不同的网络相互公告它们的 IP 地址，以及它们为下游（即它们的客户）提供连接的 IP 地址。一旦两个网络建立了 BGP 会话，它们各自的路由就会交换，并且流量可以直接在它们之间流动。

#### IXP 或 PNI 互连

两个网络可能认为它们的流量足够重要，以至于它们希望从 IXP 的共享基础设施转移到两个网络之间的专用互连上。PNI（专用网络互连）只是一个暗光纤连接（通常在单个数据中心或建筑物内），它直接将网络 A 上的端口与网络 B 上的端口连接起来。BGP 与共享的 IXP 对等互连设置几乎相同。